(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31949,        665]
NotebookOptionsPosition[     30207,        631]
NotebookOutlinePosition[     30845,        655]
CellTagsIndexPosition[     30802,        652]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"SelectedNotebook", "[", "]"}], ",", 
    RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Printout\>\""}], ",", 
    RowBox[{"ShowSyntaxStyles", "\[Rule]", "True"}]}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"de1e5a1a-4e5e-4534-a84b-5a2a0ba12cd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "=", "30"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Birth", " ", "rate"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "=", "0.05"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Death", " ", "rate"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "12"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"35.5", ",", "35.5"}], "}"}]}], ";"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"mean", "=", "6"}], ",", 
    RowBox[{"var", "=", "0.5"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"8.5", ",", "8.5"}], "}"}]}], ";"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"mean", "=", "6"}], ",", 
    RowBox[{"var", "=", "2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "1.3"}], "}"}]}], ";"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"mean", "=", "6"}], ",", 
    RowBox[{"var", "=", "10"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"mean", "=", "6"}], ",", 
    RowBox[{"var", "=", "30"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalObservation", "=", "102"}], " ", ";", " ", 
  RowBox[{"(*", "min", "*)"}], "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{
  3.73357528383279*^9, {3.7335753531839066`*^9, 3.733575358059595*^9}, {
   3.733575418597278*^9, 3.733575422863357*^9}, {3.7335756952029495`*^9, 
   3.7335757414323173`*^9}, {3.7335789403869348`*^9, 3.733578962701844*^9}, {
   3.733579015551173*^9, 3.733579045226385*^9}, {3.733579266359051*^9, 
   3.733579277985467*^9}, {3.733581726902526*^9, 3.7335817580464363`*^9}, {
   3.734167272377694*^9, 3.7341674040648804`*^9}, {3.7341680205261273`*^9, 
   3.7341680277300243`*^9}, 3.734168625399746*^9, 3.734168785159382*^9, {
   3.7341693735629487`*^9, 3.7341694770535064`*^9}, 3.734206005916216*^9, {
   3.734206168631941*^9, 3.7342061742421618`*^9}, {3.734214399393946*^9, 
   3.734214402581771*^9}, {3.7342147751950703`*^9, 3.73421477921111*^9}, {
   3.7428630371197853`*^9, 3.7428630766066704`*^9}, {3.7545214755781593`*^9, 
   3.7545214761749954`*^9}},ExpressionUUID->"2af04950-7bdb-4e9f-bd28-\
d36293b8518f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sim", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"x", "=", "0"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "population"}], "*)"}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"currentTime", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"stackTime", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"Last", "@", 
           RowBox[{"Reap", "@", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"a1", "=", "\[Lambda]"}], "   ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"a2", "=", 
                RowBox[{"\[Mu]", " ", "X"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"a0", "=", 
                RowBox[{"Total", "@", 
                 RowBox[{"{", 
                  RowBox[{"a1", ",", "a2"}], "}"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"reactionVec", "=", 
                RowBox[{
                 FractionBox["1", "a0"], 
                 RowBox[{"Accumulate", "@", 
                  RowBox[{"{", 
                   RowBox[{"a1", ",", "a2"}], "}"}]}]}]}], ";", "\n", 
               "             ", "\[IndentingNewLine]", 
               RowBox[{"tWait", "=", 
                RowBox[{"RandomVariate", "@", 
                 RowBox[{"ExponentialDistribution", "[", "a0", "]"}]}]}], ";",
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"currentTime", "=", 
                RowBox[{"currentTime", "+", "tWait"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
               "If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "currentTime", "\[GreaterEqual]", "totalObservation"}], ",", 
                 "Break", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"stackTime", "=", 
                   RowBox[{"Sort", "@", "stackTime"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"minStack", "=", 
                   RowBox[{"Min", "[", "stackTime", "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                  "Which", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"currentTime", "<", "minStack"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", "      ", 
                    RowBox[{
                    RowBox[{"reaction", "=", 
                    RowBox[{"First", "@", 
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{
                    RowBox[{"reactionVec", "-", 
                    RowBox[{"RandomReal", "[", "]"}]}], ",", 
                    RowBox[{"_", "?", "Positive"}]}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Which", "[", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"reaction", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"{", 
                    RowBox[{"currentTime", ",", "X"}], "}"}]}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"stackTime", ",", 
                    RowBox[{"currentTime", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"RandomVariate", "@", 
                    RowBox[{"BetaDistribution", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}]}]}]}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"reaction", "\[Equal]", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Sow", "@", 
                    RowBox[{"{", 
                    RowBox[{"currentTime", ",", 
                    RowBox[{"X", "-=", "1"}]}], "}"}]}], "}"}]}], "]"}]}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minStack", "<", "currentTime"}], ",", " ", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sow", "@", 
                    RowBox[{"{", 
                    RowBox[{"minStack", ",", 
                    RowBox[{"X", "+=", "1"}]}], "}"}]}], ",", 
                    RowBox[{"currentTime", "=", "minStack"}], ",", 
                    RowBox[{"stackTime", "=", 
                    RowBox[{"Rest", "@", "stackTime"}]}]}], "}"}]}], " ", 
                   "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              "15000"}], "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "x"}], "}"}]}], "]"}]}], ",", "500"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.727101858735648*^9, 3.7271018609805546`*^9}, 
   3.7271160410440264`*^9, {3.727116081589332*^9, 3.7271161264067755`*^9}, 
   3.727195591633151*^9, {3.7272028589787717`*^9, 3.7272028637067394`*^9}, {
   3.7272034061861787`*^9, 3.727203407122386*^9}, {3.727203795954004*^9, 
   3.7272038013862047`*^9}, 3.7272039419458733`*^9, {3.7272045197452803`*^9, 
   3.727204541696246*^9}, {3.72720598186364*^9, 3.7272059882959566`*^9}, {
   3.727207726044781*^9, 3.7272078291252575`*^9}, {3.7272078804445195`*^9, 
   3.7272078811557107`*^9}, 3.7272079765958633`*^9, 3.727208045077321*^9, {
   3.7272089709621625`*^9, 3.7272089838252134`*^9}, {3.7272090671539927`*^9, 
   3.7272090715419893`*^9}, 3.727209106134842*^9, 3.7272091363466573`*^9, 
   3.727209169796142*^9, {3.727213737451576*^9, 3.72721376665935*^9}, 
   3.7272138101792088`*^9, {3.7272140518180804`*^9, 3.727214067578825*^9}, 
   3.727214170364438*^9, {3.727214296564268*^9, 3.727214311890283*^9}, 
   3.7272143848837132`*^9, {3.7272144278590546`*^9, 3.7272144305797443`*^9}, {
   3.7272144685226593`*^9, 3.7272144722583246`*^9}, {3.7272155887798357`*^9, 
   3.727215589417757*^9}, {3.727216183630782*^9, 3.727216217420504*^9}, {
   3.727221651387548*^9, 3.727221673981971*^9}, 3.72722194161435*^9, {
   3.727222160081668*^9, 3.7272221618303413`*^9}, {3.727222461871982*^9, 
   3.727222461956452*^9}, {3.7272229572926636`*^9, 3.727222985949663*^9}, {
   3.727226003803446*^9, 3.727226032698492*^9}, {3.7273132182275057`*^9, 
   3.727313266896456*^9}, 3.7273134524414687`*^9, 3.7273135809522476`*^9, {
   3.727313633593741*^9, 3.727313633696731*^9}, 3.7273137818959494`*^9, {
   3.727313850927969*^9, 3.7273138520629873`*^9}, {3.727313900016366*^9, 
   3.727313900111021*^9}, {3.7273139550479174`*^9, 3.7273139554068127`*^9}, {
   3.72731447554428*^9, 3.727314519047776*^9}, {3.7273147171666183`*^9, 
   3.7273147180860806`*^9}, {3.7273147991596584`*^9, 3.727314817398034*^9}, {
   3.7273149187663803`*^9, 3.727314918999054*^9}, {3.727459521631466*^9, 
   3.727459551587781*^9}, 3.7274596370967193`*^9, 3.727561765056547*^9, 
   3.727563351743536*^9, {3.7276578622160316`*^9, 3.7276578623410473`*^9}, 
   3.7276581713946495`*^9, {3.7276588490892897`*^9, 3.727658941177782*^9}, 
   3.727659695421752*^9, 3.727659809176468*^9, 3.7276599225636005`*^9, 
   3.7283123715292673`*^9, {3.72831250205871*^9, 3.7283125049652557`*^9}, {
   3.7283129306665196`*^9, 3.728312932494822*^9}, {3.7283139778757534`*^9, 
   3.7283139794854827`*^9}, {3.7283144765238457`*^9, 3.7283145152156205`*^9}, 
   3.728316874630299*^9, 3.728317029661231*^9, {3.7283171999760776`*^9, 
   3.7283172006638393`*^9}, {3.728320455244889*^9, 3.728320508547378*^9}, 
   3.728321185065128*^9, {3.7283242047404966`*^9, 3.7283242264412746`*^9}, 
   3.7283245111434155`*^9, 3.7283390968592777`*^9, 3.7283460667469635`*^9, 
   3.728346460468091*^9, {3.728346493298085*^9, 3.7283464969606543`*^9}, {
   3.728346758652032*^9, 3.7283467736597843`*^9}, 3.7283468056739645`*^9, {
   3.7283483615044065`*^9, 3.72834836280828*^9}, {3.728350138638607*^9, 
   3.7283501692216043`*^9}, {3.7283502068217573`*^9, 3.728350225654561*^9}, {
   3.728478270417349*^9, 3.7284782833298845`*^9}, 3.7284784344496074`*^9, {
   3.728478862499237*^9, 3.7284789527950745`*^9}, {3.728481373552507*^9, 
   3.7284813811471853`*^9}, {3.7284814130597897`*^9, 3.728481416405207*^9}, 
   3.728481449728994*^9, {3.7284815032029476`*^9, 3.728481503577811*^9}, {
   3.7286040824360514`*^9, 3.7286041902446947`*^9}, {3.7286061901785097`*^9, 
   3.7286062034611816`*^9}, {3.7286063696376305`*^9, 3.728606392859075*^9}, 
   3.7287341531258616`*^9, {3.7287341975573587`*^9, 3.728734199364529*^9}, {
   3.7287347993240604`*^9, 3.7287348009746113`*^9}, {3.728738321106216*^9, 
   3.72873833623695*^9}, {3.728738420202242*^9, 3.7287384235470533`*^9}, {
   3.728738767913813*^9, 3.7287388077057056`*^9}, 3.7287388544126573`*^9, {
   3.728754004684141*^9, 3.728754027483387*^9}, 3.7287550263592825`*^9, {
   3.72875536343779*^9, 3.7287553650629673`*^9}, 3.728755487518343*^9, {
   3.7287556073332186`*^9, 3.7287556087710505`*^9}, 3.7294314976410627`*^9, {
   3.72943185565197*^9, 3.729431857214666*^9}, {3.7294320644613576`*^9, 
   3.729432100058824*^9}, {3.7294322818305197`*^9, 3.7294322904564686`*^9}, {
   3.72943300947182*^9, 3.72943302322309*^9}, {3.7330892761751814`*^9, 
   3.7330892919594107`*^9}, {3.733089387909712*^9, 3.733089428867796*^9}, {
   3.733089495452465*^9, 3.7330895625718527`*^9}, {3.7330896036633725`*^9, 
   3.73308964290093*^9}, {3.733089674981248*^9, 3.733089755486599*^9}, {
   3.7330898282546453`*^9, 3.7330898615169873`*^9}, {3.733089895195887*^9, 
   3.7330899015736246`*^9}, 3.733089936192946*^9, {3.733090339750923*^9, 
   3.7330903650847244`*^9}, 3.7330904059029093`*^9, {3.7330912983976307`*^9, 
   3.733091309866973*^9}, {3.7330919043300333`*^9, 3.7330919407595415`*^9}, {
   3.733092191304112*^9, 3.733092195468175*^9}, 3.73309226610917*^9, {
   3.7330924476199894`*^9, 3.7330924482304068`*^9}, 3.7330925760089645`*^9, {
   3.733092660880678*^9, 3.73309266456706*^9}, {3.7330930832475705`*^9, 
   3.733093127512931*^9}, {3.7330933400596795`*^9, 3.7330933580113754`*^9}, {
   3.7330936053467207`*^9, 3.7330936252080107`*^9}, 3.7330939736117334`*^9, 
   3.7330940080175066`*^9, {3.7330940571936717`*^9, 3.7330941125354996`*^9}, {
   3.7330941973751855`*^9, 3.733094224359193*^9}, {3.733094342139744*^9, 
   3.7330943494041944`*^9}, {3.7330943812005625`*^9, 
   3.7330944286421757`*^9}, {3.733094484285904*^9, 3.733094484407277*^9}, 
   3.733094555488003*^9, 3.733095101642705*^9, {3.7330956517384005`*^9, 
   3.733095665507627*^9}, 3.733095745367231*^9, 3.73309629770642*^9, 
   3.733096934448723*^9, {3.733261545155094*^9, 3.7332615721427774`*^9}, {
   3.7332616357873316`*^9, 3.733261638474923*^9}, {3.7332616827419715`*^9, 
   3.7332617699268827`*^9}, {3.733261909224744*^9, 3.733262004778104*^9}, {
   3.7332620469828196`*^9, 3.7332620774143724`*^9}, {3.7332621277809343`*^9, 
   3.733262142407311*^9}, {3.733262285741373*^9, 3.7332623009574127`*^9}, {
   3.733262351596449*^9, 3.733262405607955*^9}, {3.7332624611820292`*^9, 
   3.733262509619255*^9}, {3.7332627236207237`*^9, 3.7332627569566016`*^9}, {
   3.733262810193728*^9, 3.7332628429106517`*^9}, {3.733509809291341*^9, 
   3.733509814807553*^9}, {3.7335100512232866`*^9, 3.7335100531453667`*^9}, {
   3.7335103176233587`*^9, 3.733510326139857*^9}, {3.7335106306443396`*^9, 
   3.7335108503551817`*^9}, {3.733510999839936*^9, 3.7335110252176304`*^9}, {
   3.733511058017822*^9, 3.73351109350613*^9}, {3.733511375909644*^9, 
   3.73351145069458*^9}, {3.733511528449567*^9, 3.733511528980906*^9}, {
   3.733511572094861*^9, 3.7335115930970573`*^9}, {3.7335116721211042`*^9, 
   3.733511691827972*^9}, 3.7335117760086093`*^9, {3.733511841187405*^9, 
   3.7335118506729774`*^9}, {3.733526052702956*^9, 3.733526221082423*^9}, {
   3.7335262854041185`*^9, 3.7335263569339094`*^9}, {3.733526420262925*^9, 
   3.733526438069638*^9}, {3.7335265077501345`*^9, 3.733526508692172*^9}, {
   3.733526555909607*^9, 3.733526594446992*^9}, {3.7335267853898125`*^9, 
   3.7335268272555227`*^9}, {3.7335276449029684`*^9, 
   3.7335276508265004`*^9}, {3.733527744903369*^9, 3.7335277718995543`*^9}, {
   3.7335279061124353`*^9, 3.733527920869066*^9}, 3.733528123492525*^9, {
   3.733528176317336*^9, 3.7335281871954155`*^9}, {3.7335282327582846`*^9, 
   3.7335282711742363`*^9}, 3.733528304197509*^9, {3.733575077576889*^9, 
   3.733575081264744*^9}, {3.7335751390990105`*^9, 3.7335751556478224`*^9}, 
   3.7335752520325427`*^9, {3.7335752859894447`*^9, 3.7335752891146297`*^9}, 
   3.733575427160512*^9, {3.733575743010459*^9, 3.733575755964937*^9}, {
   3.7335789880484285`*^9, 3.7335789893140116`*^9}, 3.7335790565088387`*^9, {
   3.733579166192171*^9, 3.733579233293068*^9}, {3.7335817459825153`*^9, 
   3.733581753233262*^9}, {3.733709810114643*^9, 3.7337098155791845`*^9}, {
   3.7337664949090295`*^9, 3.7337664950027905`*^9}, {3.733766683771702*^9, 
   3.7337666838654594`*^9}, {3.733767803269417*^9, 3.733767805426216*^9}, {
   3.733767926556053*^9, 3.733767992219203*^9}, 3.7338898810535445`*^9, {
   3.7338900174991417`*^9, 3.733890021718341*^9}, {3.7338900551750865`*^9, 
   3.7338900696975927`*^9}, {3.734167423770342*^9, 3.734167446069456*^9}, 
   3.7341683641689887`*^9, 3.7341686551921616`*^9, {3.7341694910081825`*^9, 
   3.734169491564426*^9}, 3.734205998321636*^9, {3.7342061823365307`*^9, 
   3.7342061836022987`*^9}, {3.734214101040151*^9, 3.7342141240110884`*^9}, {
   3.7545214939223785`*^9, 
   3.7545215060260553`*^9}},ExpressionUUID->"475efa80-acea-4736-9cb8-\
c4c97f27f2d7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Tau]", "=", "6"}], ",", "x"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"A", " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{"t", "-", "\[Tau]"}], "]"}]}], "-", " ", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"x", "[", "t", "]"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "/;", 
             RowBox[{"t", "\[LessEqual]", "0"}]}], "]"}], "\[Equal]", "0"}]}],
          "}"}], ",", 
        RowBox[{"x", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "120"}], "}"}]}], "]"}]}]}], "]"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7335746255375924`*^9, 3.733574738164586*^9}, {
   3.7335748378316135`*^9, 3.7335749715032578`*^9}, 3.7335750451673365`*^9, {
   3.7335752010118036`*^9, 3.7335752307413626`*^9}, {3.7335753231652737`*^9, 
   3.7335753414953356`*^9}, {3.733579104654563*^9, 3.7335791195934653`*^9}, {
   3.7335809572260914`*^9, 3.7335809580701046`*^9}, {3.733580992823624*^9, 
   3.733580993401802*^9}, 3.7337666117127905`*^9, 3.733766678599248*^9, 
   3.733766755769001*^9, {3.7337678885299006`*^9, 3.7337679004700813`*^9}, {
   3.73389000585748*^9, 3.733890012045675*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"8114b3c3-9da5-460b-9143-c7a554ce87ac"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"fig", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"sim", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Time\>\"", ",", "\"\<Population\>\""}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{"sol", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "120"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.728481199556116*^9, 3.728481202009506*^9}, 
   3.7284813999451017`*^9, 3.7294314256021614`*^9, {3.733575120315801*^9, 
   3.73357513150463*^9}, {3.7335751697899504`*^9, 3.7335751736497355`*^9}, {
   3.733575593457754*^9, 3.733575647479117*^9}, {3.733575902773342*^9, 
   3.733575902960866*^9}, {3.7336503236315255`*^9, 3.7336503256942635`*^9}, 
   3.733766614228698*^9, 3.733766676302096*^9, 3.7337667583903904`*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"3a6e907a-4a63-438d-8d38-e1183fe65c99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StepFunction", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sdata", ",", "nf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"sdata", "=", 
       RowBox[{"Sort", "@", "data"}]}], ";", 
      RowBox[{"nf", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"sdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Rule]", 
         "\"\<Index\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"StepFunction", "[", 
       RowBox[{"nf", ",", 
        RowBox[{"sdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"sdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StepFunction", "[", 
    RowBox[{"nf_NearestFunction", ",", "x_", ",", "y_", ",", "clip_"}], "]"}],
    "[", "pt_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"near", "=", 
      RowBox[{
       RowBox[{"nf", "[", "pt", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"List", "@", "pt"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", "[", 
        RowBox[{"[", 
         RowBox[{"Clip", "[", 
          RowBox[{
           RowBox[{"near", "+", 
            RowBox[{"Clip", "[", 
             RowBox[{
              RowBox[{"Sign", "[", 
               RowBox[{"Subtract", "[", 
                RowBox[{"pt", ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", "near", "]"}], "]"}]}], "]"}], "]"}], ",", 
              "clip"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], "]"}], 
        "]"}], "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.734209079750782*^9, 3.734209089096775*^9}, {
  3.7342091572114744`*^9, 3.7342092648930645`*^9}, {3.7342093008330793`*^9, 
  3.734209339601384*^9}, {3.734209388242609*^9, 3.734209408423092*^9}, {
  3.734210631149897*^9, 3.73421068937473*^9}, {3.7342108040358686`*^9, 
  3.7342108390907793`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"201f58a9-222f-4bea-beb9-d6e17dab92cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Tau]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{
       RowBox[{"StepFunction", "[", 
        RowBox[{"sim", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{"sim", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", "\[Tau]"}], 
        "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "sim"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7341212457696147`*^9, 3.7341212457855043`*^9}, {
   3.7341677445381165`*^9, 3.734167802275194*^9}, {3.7341680628364444`*^9, 
   3.7341680833386755`*^9}, {3.7341681296436777`*^9, 3.7341681315188923`*^9}, 
   3.734213995091666*^9, {3.734214027045396*^9, 3.7342140372651253`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"32e07439-eac4-4b7d-9801-e2180c919290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{"#", ",", "100"}], "]"}], "&"}], "/@", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7287554110053654`*^9, 3.7287554115835514`*^9}, {
   3.7287555222095423`*^9, 3.7287555569786787`*^9}, 3.7287556012075653`*^9, 
   3.7287556346017876`*^9, {3.7341683378545227`*^9, 3.734168338057653*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"1577234e-3ffd-43e8-8981-05c07608bf1c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"data", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Time\>\"", ",", "\"\<Population\>\""}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.728481199556116*^9, 3.728481202009506*^9}, 
   3.7284813999451017`*^9, 3.7294314256021614`*^9, {3.733575120315801*^9, 
   3.73357513150463*^9}, {3.7335751697899504`*^9, 3.7335751736497355`*^9}, {
   3.733575593457754*^9, 3.733575647479117*^9}, {3.733575902773342*^9, 
   3.733575902960866*^9}, {3.7336503236315255`*^9, 3.7336503256942635`*^9}, 
   3.733766614228698*^9, 3.733766676302096*^9, 3.7337667583903904`*^9, {
   3.7341683052750034`*^9, 3.7341683153989563`*^9}, 3.734206204588952*^9, 
   3.7342143705941525`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"17e8cd75-6bc3-4e4b-b452-f002ce33933f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<BetaXVar05.csv\>\""}], ",", 
     RowBox[{"Transpose", "@", "data"}]}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.7284765923970118`*^9, {3.7284766603013277`*^9, 3.728476667968693*^9}, {
   3.7284767086353197`*^9, 3.7284767109138536`*^9}, 3.7284791043455687`*^9, {
   3.728479245777829*^9, 3.728479255198187*^9}, 3.7284801576202545`*^9, {
   3.7284804644723496`*^9, 3.728480470007804*^9}, {3.728606432378936*^9, 
   3.728606466538849*^9}, {3.728734046066508*^9, 3.7287340488805933`*^9}, 
   3.728755098069875*^9, {3.7287553933784847`*^9, 3.7287554401178455`*^9}, {
   3.728755494394063*^9, 3.728755496347413*^9}, 3.7287555731993604`*^9, {
   3.729431521159373*^9, 3.7294315601166425`*^9}, 3.7294322997855597`*^9, {
   3.729432733176676*^9, 3.729432733254797*^9}, 3.733890523361124*^9, {
   3.7341675570849257`*^9, 3.7341675577256174`*^9}, {3.734169509191348*^9, 
   3.7341695097070227`*^9}, 3.7342059603986263`*^9, {3.7342143766729264`*^9, 
   3.7342143813296127`*^9}, 3.734224765503848*^9},
 CellLabel->"In[94]:=",ExpressionUUID->"ec443e4f-e714-41b0-82d7-4c6b9ca2a2fb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<BetaXVar2.csv\>\""}], ",", 
     RowBox[{"Transpose", "@", "data"}]}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.7284765923970118`*^9, {3.7284766603013277`*^9, 3.728476667968693*^9}, {
   3.7284767086353197`*^9, 3.7284767109138536`*^9}, 3.7284791043455687`*^9, {
   3.728479245777829*^9, 3.728479255198187*^9}, 3.7284801576202545`*^9, {
   3.7284804644723496`*^9, 3.728480470007804*^9}, {3.728606432378936*^9, 
   3.728606466538849*^9}, {3.728734046066508*^9, 3.7287340488805933`*^9}, 
   3.728755098069875*^9, {3.7287553933784847`*^9, 3.7287554401178455`*^9}, {
   3.728755494394063*^9, 3.728755496347413*^9}, 3.7287555731993604`*^9, {
   3.729431521159373*^9, 3.7294315601166425`*^9}, 3.7294322997855597`*^9, {
   3.729432733176676*^9, 3.729432733254797*^9}, 3.733890523361124*^9, 
   3.7341675612416267`*^9, 3.734169518864298*^9, 3.7342059649147243`*^9, 
   3.7342147660066752`*^9, 3.734224766800902*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"799ae7cc-0b01-44e1-9621-13c2b7f67431"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<BetaXVar10.csv\>\""}], ",", 
     RowBox[{"Transpose", "@", "data"}]}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.7284765923970118`*^9, {3.7284766603013277`*^9, 3.728476667968693*^9}, {
   3.7284767086353197`*^9, 3.7284767109138536`*^9}, 3.7284791043455687`*^9, {
   3.728479245777829*^9, 3.728479255198187*^9}, 3.7284801576202545`*^9, {
   3.7284804644723496`*^9, 3.728480470007804*^9}, {3.728606432378936*^9, 
   3.728606466538849*^9}, {3.728734046066508*^9, 3.7287340488805933`*^9}, 
   3.728755098069875*^9, {3.7287553933784847`*^9, 3.7287554401178455`*^9}, {
   3.728755494394063*^9, 3.728755496347413*^9}, 3.7287555731993604`*^9, {
   3.729431521159373*^9, 3.7294315601166425`*^9}, 3.7294322997855597`*^9, {
   3.729432733176676*^9, 3.729432733254797*^9}, 3.733890523361124*^9, 
   3.7341695217395763`*^9, 3.734205969602729*^9, 3.734214936606621*^9, 
   3.7342247683166513`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"250c8380-4ca0-47e4-abc2-91f50fd718cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<BetaXVar30.csv\>\""}], ",", 
    RowBox[{"Transpose", "@", "data"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.742863088981724*^9, 3.742863096620797*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"acb89e1e-009d-418f-9aed-af57b07b4c81"]
},
PrintingStyleEnvironment->"Printout",
WindowSize->{1813, 946},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Landscape",
"PaperSize"->{792, 612},
"PrintingMargins"->{{14.4, 14.4}, {36., 36.}}},
ShowSyntaxStyles->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"MyDefault_Cinar.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 407, 8, 70, "Input",ExpressionUUID->"de1e5a1a-4e5e-4534-a84b-5a2a0ba12cd6"],
Cell[968, 30, 2827, 75, 332, "Input",ExpressionUUID->"2af04950-7bdb-4e9f-bd28-d36293b8518f"],
Cell[3798, 107, 14320, 236, 1463, "Input",ExpressionUUID->"475efa80-acea-4736-9cb8-c4c97f27f2d7"],
Cell[18121, 345, 1676, 40, 100, "Input",ExpressionUUID->"8114b3c3-9da5-460b-9143-c7a554ce87ac"],
Cell[19800, 387, 1280, 27, 100, "Input",ExpressionUUID->"3a6e907a-4a63-438d-8d38-e1183fe65c99"],
Cell[21083, 416, 2502, 69, 187, "Input",ExpressionUUID->"201f58a9-222f-4bea-beb9-d6e17dab92cf"],
Cell[23588, 487, 1074, 26, 100, "Input",ExpressionUUID->"32e07439-eac4-4b7d-9801-e2180c919290"],
Cell[24665, 515, 581, 13, 70, "Input",ExpressionUUID->"1577234e-3ffd-43e8-8981-05c07608bf1c"],
Cell[25249, 530, 1025, 18, 70, "Input",ExpressionUUID->"17e8cd75-6bc3-4e4b-b452-f002ce33933f"],
Cell[26277, 550, 1243, 22, 70, "Input",ExpressionUUID->"ec443e4f-e714-41b0-82d7-4c6b9ca2a2fb"],
Cell[27523, 574, 1160, 21, 70, "Input",ExpressionUUID->"799ae7cc-0b01-44e1-9621-13c2b7f67431"],
Cell[28686, 597, 1137, 21, 70, "Input",ExpressionUUID->"250c8380-4ca0-47e4-abc2-91f50fd718cf"],
Cell[29826, 620, 377, 9, 70, "Input",ExpressionUUID->"acb89e1e-009d-418f-9aed-af57b07b4c81"]
}
]
*)

